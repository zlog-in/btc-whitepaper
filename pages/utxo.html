<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTXO 模型 · 比特币白皮书</title>
    <meta data-i18n-title="title.utxo">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>₿</text></svg>">
    <link rel="stylesheet" href="../css/style.css?v=20260206a">
</head>
<body>
    <nav class="nav">
        <div class="nav-content">
            <a href="../index.html" class="logo">
                <span class="logo-title" data-i18n="nav.logo">₿ Bitcoin Whitepaper</span>
                <span class="logo-subtitle" data-i18n="nav.subtitle">交互式学习指南</span>
            </a>
            <a href="../index.html" class="nav-home" data-i18n="nav.home">🏠 首页</a>
            <div class="nav-groups">
                <div class="nav-group">
                    <div class="nav-group-title">
                        <span><span class="group-icon">🔐</span><span data-i18n="nav.group.crypto">密码学</span></span>
                        <span class="expand-icon">▶</span>
                    </div>
                    <div class="nav-group-links">
                        <a href="hash.html" data-i18n="nav.hash">哈希函数</a>
                        <a href="sha256.html" class="sub-link" data-i18n="nav.sha256">└ SHA-256 过程</a>
                        <a href="merkle.html" class="sub-link" data-i18n="nav.merkle">└ Merkle Tree</a>
                        <a href="signature.html" data-i18n="nav.signature">数字签名</a>
                        <a href="ecdsa.html" class="sub-link" data-i18n="nav.ecdsa">└ ECDSA 过程</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">
                        <span><span class="group-icon">📍</span><span data-i18n="nav.group.address">地址</span></span>
                        <span class="expand-icon">▶</span>
                    </div>
                    <div class="nav-group-links">
                        <a href="address.html" data-i18n="nav.address">比特币地址</a>
                        <a href="multisig.html" class="sub-link" data-i18n="nav.multisig">└ 多重签名</a>
                        <a href="timelock.html" class="sub-link" data-i18n="nav.timelock">└ 时间锁</a>
                        <a href="htlc.html" class="sub-link" data-i18n="nav.htlc">└ 哈希时间锁</a>
                    </div>
                </div>
                <div class="nav-group expanded has-active">
                    <div class="nav-group-title">
                        <span><span class="group-icon">💰</span><span data-i18n="nav.group.tx">交易</span></span>
                        <span class="expand-icon">▶</span>
                    </div>
                    <div class="nav-group-links">
                        <a href="cash.html" data-i18n="nav.cash">现金模型</a>
                        <a href="utxo.html" class="sub-link active" data-i18n="nav.utxo">└ UTXO 模型</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">
                        <span><span class="group-icon">📦</span><span data-i18n="nav.group.block">区块</span></span>
                        <span class="expand-icon">▶</span>
                    </div>
                    <div class="nav-group-links">
                        <a href="block.html" data-i18n="nav.block">区块结构</a>
                        <a href="mining.html" class="sub-link" data-i18n="nav.mining">└ 挖矿原理</a>
                        <a href="chain.html" data-i18n="nav.chain">区块链</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">
                        <span><span class="group-icon">🌐</span><span data-i18n="nav.group.consensus">共识</span></span>
                        <span class="expand-icon">▶</span>
                    </div>
                    <div class="nav-group-links">
                        <a href="pow.html" data-i18n="nav.pow">工作量证明</a>
                        <a href="p2p.html" data-i18n="nav.p2p">共识传播</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main>
        <section class="section">
            <div class="container">
                <div class="page-header">
                    <span class="page-icon">💰</span>
                    <div>
                        <h1 data-i18n="utxo.title">UTXO 模型</h1>
                        <p class="section-desc" data-i18n="utxo.desc">通过交互式演示，亲身体验比特币 UTXO (Unspent Transaction Output) 的工作原理。选择 UTXO、创建交易、签名并广播。</p>
                    </div>
                </div>

                <!-- 快速回顾 -->
                <div class="card info">
                    <h4 data-i18n="utxo.review.title">📖 快速回顾</h4>
                    <p data-i18n-html="utxo.review.desc">UTXO 就像你钱包里的现金钞票：每张钞票必须完整使用，多余的金额作为找零返还。如果还不了解 UTXO 的基本概念，建议先阅读 <a href="cash.html">现金模型</a> 页面。</p>
                </div>

                <!-- 余额计算 -->
                <div class="demo-box">
                    <h3 data-i18n="utxo.balance.title">💳 我的钱包</h3>
                    <p class="demo-desc" data-i18n="utxo.balance.desc">你的"余额"实际上是所有属于你的 UTXO 金额之和。点击 UTXO 选择作为交易输入。</p>

                    <div class="utxo-wallet">
                        <!-- 钱包密钥信息 -->
                        <div class="wallet-keys">
                            <div class="key-row">
                                <span class="key-label" data-i18n="utxo.wallet.privkey">🔐 私钥:</span>
                                <code class="key-value private-key" id="wallet-private-key">生成中...</code>
                                <span class="key-warning" data-i18n="utxo.wallet.privkey.warn">⚠️ 绝不要分享你的私钥！</span>
                            </div>
                            <div class="key-row">
                                <span class="key-label" data-i18n="utxo.wallet.pubkey">📢 公钥:</span>
                                <code class="key-value public-key" id="wallet-public-key">生成中...</code>
                            </div>
                            <div class="key-row">
                                <span class="key-label" data-i18n="utxo.wallet.address">📍 地址:</span>
                                <code class="key-value address" id="wallet-address">生成中...</code>
                            </div>
                        </div>

                        <div class="wallet-header">
                            <div class="wallet-balance">
                                <span class="wallet-label" data-i18n="utxo.wallet.balance">总余额:</span>
                                <span class="wallet-value" id="wallet-balance">0 BTC</span>
                            </div>
                            <button id="new-wallet" class="btn secondary btn-sm" data-i18n="utxo.wallet.new">🔄 生成新钱包</button>
                        </div>

                        <div class="utxo-list" id="utxo-list">
                            <!-- UTXOs will be dynamically inserted here -->
                        </div>

                        <button id="add-utxo" class="btn" data-i18n="utxo.add.btn">➕ 模拟收款</button>

                        <!-- 收款详情显示 -->
                        <div class="receive-info" id="receive-info" style="display: none;">
                            <h4 data-i18n="utxo.receive.success">📥 收款成功！</h4>
                            <div class="receive-details">
                                <div class="receive-row">
                                    <span data-i18n="utxo.receive.txid">交易ID:</span>
                                    <code id="receive-txid">-</code>
                                </div>
                                <div class="receive-row">
                                    <span data-i18n="utxo.receive.amount">金额:</span>
                                    <strong id="receive-amount">-</strong>
                                </div>
                                <div class="receive-row">
                                    <span data-i18n="utxo.receive.from">发送方:</span>
                                    <code id="receive-from">-</code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 创建交易 -->
                <div class="demo-box">
                    <h3 data-i18n="utxo.tx.title">💸 创建交易</h3>
                    <p class="demo-desc" data-i18n="utxo.tx.desc">选择要花费的 UTXO，设置发送金额，用私钥签名后广播交易。</p>

                    <div class="tx-builder">
                        <div class="tx-section">
                            <h4 data-i18n="utxo.tx.inputs">📥 选择输入 (UTXO)</h4>
                            <div class="tx-inputs" id="tx-inputs">
                                <p class="empty-hint" data-i18n="utxo.tx.select">点击上方的 UTXO 来选择作为输入</p>
                            </div>
                            <div class="tx-input-total">
                                <span data-i18n="utxo.tx.input.total">输入总额:</span>
                                <span id="input-total">0 BTC</span>
                            </div>
                        </div>

                        <div class="tx-arrow-section">
                            <div class="tx-big-arrow">→</div>
                            <div class="tx-label" data-i18n="utxo.tx.label">交易</div>
                        </div>

                        <div class="tx-section">
                            <h4 data-i18n="utxo.tx.outputs">📤 设置输出</h4>
                            <div class="tx-output-form">
                                <div class="output-row">
                                    <label data-i18n="utxo.tx.recipient">接收地址:</label>
                                    <div class="recipient-input-group">
                                        <input type="text" id="recipient-address" placeholder="点击生成随机地址" data-i18n-placeholder="utxo.tx.recipient.placeholder" readonly>
                                        <button id="gen-recipient" class="btn btn-sm" data-i18n="utxo.tx.gen.random">🎲 随机生成</button>
                                    </div>
                                </div>
                                <div class="output-row">
                                    <label data-i18n="utxo.tx.amount">发送金额:</label>
                                    <input type="number" id="send-amount" placeholder="0.5" step="0.001" min="0">
                                    <span class="unit">BTC</span>
                                </div>
                            </div>
                            <div class="tx-outputs-preview" id="tx-outputs-preview">
                                <!-- Outputs preview will be shown here -->
                            </div>
                            <div class="tx-summary">
                                <div class="summary-row">
                                    <span data-i18n="utxo.tx.send">发送:</span>
                                    <span id="summary-send">0 BTC</span>
                                </div>
                                <div class="summary-row">
                                    <span data-i18n="utxo.tx.change">找零:</span>
                                    <span id="summary-change">0 BTC</span>
                                </div>
                                <div class="summary-row fee">
                                    <span data-i18n="utxo.tx.fee">手续费:</span>
                                    <span id="summary-fee">0.0001 BTC</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="send-tx" class="btn primary" disabled data-i18n="utxo.tx.send.btn">📤 签名并广播交易</button>

                    <div class="tx-result" id="tx-result" style="display: none;">
                        <!-- Transaction animation will be shown here -->
                    </div>
                </div>

                <!-- UTXO 链追溯 -->
                <div class="demo-box">
                    <h3 data-i18n="utxo.chain.title">🔗 UTXO 链追溯</h3>
                    <p class="demo-desc" data-i18n="utxo.chain.desc">每个 UTXO 都可以追溯到创建它的交易，形成一条交易链。点击查看示例。</p>

                    <div class="utxo-chain" id="utxo-chain">
                        <!-- UTXO chain visualization -->
                    </div>

                    <button id="trace-utxo" class="btn" data-i18n="utxo.chain.trace">🔍 追溯示例 UTXO</button>
                </div>

                <!-- 交易结构说明 -->
                <div class="demo-box">
                    <h3 data-i18n="utxo.structure.title">📋 交易结构</h3>
                    <p class="demo-desc" data-i18n="utxo.structure.desc">每笔比特币交易都包含输入和输出两部分。</p>

                    <div class="tx-structure">
                        <div class="structure-side inputs">
                            <h4 data-i18n="utxo.structure.inputs">📥 输入 (Inputs)</h4>
                            <ul>
                                <li data-i18n-html="utxo.structure.input.1"><strong>引用之前的 UTXO</strong> - 通过 txid + vout 定位</li>
                                <li data-i18n-html="utxo.structure.input.2"><strong>解锁脚本</strong> - 提供签名证明所有权</li>
                                <li data-i18n="utxo.structure.input.3">可以有多个输入（合并多个 UTXO）</li>
                            </ul>
                        </div>
                        <div class="structure-arrow">→</div>
                        <div class="structure-side outputs">
                            <h4 data-i18n="utxo.structure.outputs">📤 输出 (Outputs)</h4>
                            <ul>
                                <li data-i18n-html="utxo.structure.output.1"><strong>金额</strong> - 发送的 BTC 数量</li>
                                <li data-i18n-html="utxo.structure.output.2"><strong>锁定脚本</strong> - 定义谁可以花费</li>
                                <li data-i18n="utxo.structure.output.3">可以有多个输出（发送 + 找零）</li>
                            </ul>
                        </div>
                    </div>

                    <div class="structure-rule" data-i18n-html="utxo.structure.rule">
                        <strong>核心规则:</strong> 输入总额 = 输出总额 + 手续费
                    </div>
                </div>

                <div class="page-nav">
                    <a href="cash.html" class="btn secondary" data-i18n="utxo.nav.prev">← 现金模型</a>
                    <a href="block.html" class="btn primary" data-i18n="utxo.nav.next">区块结构 →</a>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p><span data-i18n="footer.text">基于 Satoshi Nakamoto 的</span><a href="https://bitcoin.org/bitcoin.pdf" target="_blank" data-i18n="footer.link">比特币白皮书</a><span data-i18n="footer.suffix">制作</span></p>
    </footer>

    <script src="../js/i18n.js?v=20260206a"></script>
    <script src="../js/utxo.js?v=20260206a"></script>
</body>
</html>
